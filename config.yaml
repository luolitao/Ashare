
logging:
  # 日志级别（DEBUG/INFO/WARNING/ERROR 或数字），默认 INFO；
  level: INFO
  console_level: INFO
  file_level: INFO

app:
  output_dir: output
  # 是否拉取/增量更新日线K线数据
  fetch_daily_kline: true
  # 是否导出股票元数据
  fetch_stock_meta: true
  # 最近 N 个交易日窗口
  history_days: 600
  # 近期自然日视图窗口
  history_view_days: 45
  # 流动性排序时保留的股票数量
  top_liquidity_count: 100
  # 最少上市天数过滤阈值
  min_listing_days: 60
  # 是否刷新 Baostock 季频财务数据
  refresh_fundamentals: false
  # 是否拉取常用指数日线数据
  fetch_index_kline: true
  index_codes:
    - sh.000001
    - sh.000300
    - sh.000905
    - sz.399001
    - sz.399006
  index_history_days: 900
  # 是否创建/更新股票-行业维表
  build_stock_industry_dim: true

database:
  host: 127.0.0.1
  port: 3306
  user: root
  password: ""
  db_name: ashare
  pool_size: 5
  max_overflow: 10
  pool_recycle: 1800
  pool_timeout: 30

proxy:
  http: http://127.0.0.1:7890
  https: http://127.0.0.1:7890

baostock:
  retry: 3
  retry_sleep: 3.0
  socket_timeout: 30
  keepalive_interval: 60
  per_code_timeout: 30
  max_retries: 2
  resume_min_rows_per_code: 200
  worker_processes: 1
  min_worker_processes: 1
  max_worker_processes: 8
  network_worker_cap: 1
  progress_log_every: 100
  history_flush_batch: 5
  history_write_chunksize: 500
  history_cleanup_mode: window
  history_retention_days: 0

akshare:
  enabled: true
  lhb:
    enabled: true
  margin:
    enabled: true
    exchanges:
      - sse
      - szse
  gdhs:
    enabled: true
    period: ""
    detail_enabled: true
    detail_top_n: 100
  board_industry:
    enabled: true
    spot_enabled: true
    hist_enabled: true
    history_days: 300
    adjust: hfq
    build_stock_board_dim: true

# MA5-MA20 顺势趋势波段系统
strategy_ma5_ma20_trend:
  enabled: true
  universe_source: top_liquidity
  lookback_days: 300

  volume_ratio_threshold: 1.5
  volume_ma_window: 5
  min_signals: 3
  min_signals_cap_scale: 0.5

  pullback_band: 0.02
  near_ma20_band: 0.02
  near_cross_gap_band: 0.005
  near_signal_macd_required: false
  kdj_low_threshold: 30
  buy_confirm_require_ma5_ge_ma20: true

  stagnation_vol_ratio_threshold: 2.0
  stagnation_pct_abs_threshold: 0.01
  stagnation_ma20_bias_threshold: 0.1

  engulf_body_atr_threshold: 0.6
  engulf_vol_ratio_threshold: 1.2
  engulf_near_ma20_band: 0.02
  engulf_score_weight: 0.3
  engulf_risk_ma20_bias_threshold: 0.06

  wyckoff_enabled: true
  wyckoff_confirm_min_score: 1.0
  wyckoff_score_weight: 0.5

  soft_confirm_lookback_days: 10
  soft_confirm_cap_scale: 0.5
  quality_stop_threshold: -3.0
  quality_soft_threshold: -1.0
  quality_soft_cap_scale: 0.7

  one_word_limit_up_pct: 0.095

  # 新命名 (strategy_ + 简写)
  indicator_table: strategy_ind_daily
  signal_events_table: strategy_sig_events

  signals_write_scope: window
  signals_write_batch_days: 5
  signals_write_window_days: 10
  valid_days: 3

# 威科夫派发风控策略
strategy_wyckoff_distribution:
  enabled: true
  universe_source: top_liquidity
  lookback_days: 300
  
  ma_short: 5
  ma_long: 20
  efi_window: 60
  divergence_lookback: 30
  
  indicator_table: strategy_ind_daily
  signal_events_table: strategy_sig_events
  signals_write_scope: window
  valid_days: 3

# 低吸反转策略
strategy_low_suck_reversal:
  enabled: true
  universe_source: top_liquidity
  lookback_days: 300
  
  bias20_threshold: -0.06
  rsi_threshold: 30
  mode: conservative
  
  indicator_table: strategy_ind_daily
  signal_events_table: strategy_sig_events
  signals_write_scope: window
  valid_days: 2

# 开盘监测
open_monitor:
  enabled: true
  # 新命名 (strategy_ + 简写)
  quote_table: strategy_mon_quotes
  output_table: strategy_mon_eval
  minute_table: strategy_mon_minute
  run_table: strategy_mon_log
  open_monitor_env_table: strategy_mon_env
  
  # 关联表
  weekly_indicator_table: strategy_ind_weekly
  daily_indicator_table: strategy_ind_daily_env
  ready_signals_view: v_strategy_sig_ready
  
  index_code: sh.000001
  index_hist_lookback_days: 250
  signal_lookback_days: 5
  quote_source: eastmoney
  interval_minutes: 5
  run_id_minutes: 5
  run_id_use_seconds: true

  max_gap_up_pct: 0.05
  max_gap_up_atr_mult: 1.5
  max_gap_down_pct: -0.03
  min_open_vs_ma20_pct: 0.0
  limit_up_trigger_pct: 9.7
  max_entry_vs_ma5_pct: 0.08
  runup_atr_max: 1.2
  dev_ma5_atr_max: 2.0
  dev_ma20_atr_max: 2.5

  live_breakout_high_eps: 0.002
  live_breakout_latest_eps: 0.001
  live_retest_pct: 0.003
  live_retest_atr_mult: 0.5
  minute_fetch_timeout_sec: 5
  minute_fetch_skip_non_trading_day: true

  stop_atr_mult: 2.0
  signal_day_limit_up_pct: 0.095
  env_index_score_threshold: 1

  write_to_db: true
  incremental_write: true
  incremental_export_timestamp: true
  export_csv: false
  export_top_n: 100
  output_subdir: open_monitor

# Weekly market env config
weekly_env:
  lrc_length: 52
  lrc_dev: 2.0
  ma_fast: 30
  ma_slow: 60
  breakout_vol_ratio_threshold: 1.2
  breakdown_vol_weak_threshold: 0.9
  slope_change_ratio_threshold: 0.002
  bandwidth_lookback: 104
  bandwidth_high_quantile: 0.9
  bandwidth_cap: 0.4
  conflict_requires_vol_confirm: true
  conflict_gate: ALLOW_SMALL

# Daily market env config
daily_env:
  majority_ratio: 0.5
  breakdown_vol_weak_threshold: 0.9
  risk_off_vol_weak_threshold: 0.9
  bb_width_high_threshold: 0.12
  bb_width_high_ratio: 0.5
  high_vol_cap: 0.5
